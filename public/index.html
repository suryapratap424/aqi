<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
        integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
        crossorigin="" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.Default.css" />

    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
        integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
        crossorigin=""></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.3.0/dist/leaflet.markercluster.js"></script>
    <title>Air-Pollution</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="container">
        <input list='list' id="option" class="ontop">
        <datalist id="list">
        </datalist>
        <div id="legend" class="ontop box">
            <div id="govt"></div>
            <div id="loaded"></div>
            <div id="jtstations"></div>
        </div>
        <div id="map"></div>
        <div id="filter" class="ontop box">
            <input type="radio" class="filters" name="filter" id="Delhi">
            <label for="Delhi">Delhi</label>
            <input type="radio" class="filters" name="filter" id="Uttar_Pradesh">
            <label for="Uttar_Pradesh">Uttar Pradesh</label>
            <input type="radio" class="filters" name="filter" id="Haryana">
            <label for="Haryana">Haryana</label>
            <input type="radio" class="filters" name="filter" id="All_India">
            <label for="All_India">All India</label>
        </div>
        <div id="type" class="ontop box">
            <input type="radio" class="filters" name="type" id="Govt">
            <label for="Govt">Govt Stations</label>
            <input type="radio" class="filters" name="type" id="Aircubic">
            <label for="Aircubic">Aircubic Stations</label>
            <input type="radio" class="filters" name="type" id="all">
            <label for="all">All Stations</label>
        </div>
        <div id="device" class="ontop">
            <!-- <form action="https://jt-stationsapi.herokuapp.com/add" method="post"> -->
            <form id="add">
                <input type="text" name="id" id="id" placeholder="enter device id">
                <button type="submit">Add Device</button>
            </form>
            <script>
                const form = document.getElementById("add")
                form.addEventListener("submit", function (e) {
                    e.preventDefault();
                    const data = { id: document.getElementById('id').value }
                    console.log(data);
                    // fetch("http://localhost:8000/add", {
                    fetch("https://jt-stationsapi.herokuapp.com/add", {
                        method: 'post',
                        headers: {
                            "Content-type": "application/json"
                        },
                        body: JSON.stringify(data)
                    }).then(r => r.text()).then(x => {
                        alert(x)
                        window.location.reload()
                    })
                        .catch(e => alert(e.message))
                })
            </script>
        </div>
    </div>
</body>
<script src="./dist/leaflet.markercluster.js"></script>
<script src="./indiastations.js"></script>
<script src="./bbox.js"></script>
<script src="./layers.js"></script>
<script src="./funct.js"></script>
<script>
    function startcounter(filtered) {
        let start = 0;
        let counter = setInterval(() => {
            start += 1
            document.getElementById('govt').innerHTML = 'Government Stations - ' + start
            if (filtered.length == start)
                clearInterval(counter)
        }, 5);
    }
</script>
<script src="./index.js"></script>

</html>